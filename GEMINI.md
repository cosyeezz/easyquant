# Gemini 工作区规则

本文档记录了在此项目中与 Gemini 协作时需要遵守的特定规则和约定。

## 编码与开发

- **规则 1:** 不在正式的应用模块代码中编写测试或生成虚拟数据（dummy data）的函数。所有测试都应通过运行正式代码来完成。
- **规则 2:** 所有系统设计、代码实现和交互建议都必须达到生产级实盘交易的标准。严禁使用“初期简化”、“临时占位”或不严谨的快捷方式，除非用户明确要求制作原型。
- **规则 3:** 防止 Windows 平台乱码的强制规范：
    1. **执行命令前**: 必须在 Shell 会话中显式设置编码为 UTF-8 (例如 PowerShell 中执行 `$OutputEncoding = [System.Console]::InputEncoding = [System.Console]::OutputEncoding = [System.Text.Encoding]::UTF8`)。
    2. **Python 脚本**: 执行时必须设置环境变量 `PYTHONIOENCODING="utf-8"`。
    3. **日志查看**: 严禁直接依赖控制台输出来查看包含中文的长日志，必须重定向到文件（`> log.txt 2>&1`）后通过文本编辑器或支持编码的文件读取工具查看。
    4. **交互输出**: 确保所有工具调用返回的文本内容（如错误信息、状态报告）在呈现给用户前已正确解码，避免在交互过程中出现乱码。
    5. **源码文件**: 确保所有包含非 ASCII 字符的源码文件均以 UTF-8 编码保存。

## 交互偏好

- 用户偏好使用中文进行交互。

## 架构执行记录 (2025-12-07)

- **清理操作**: 删除 `test_events_generator.py`，因为其违反了“无独立脚本”及“API 不暴露事件创建接口”的架构规则。
- **代码修正**: 清理 `server/api/v1/events.py` 中未使用的 `record_event` 引用，强化 API 的只读属性。
- **当前状态**: 已准备好实现 `server/etl/runner.py`。